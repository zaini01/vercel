{"version":3,"sources":["App.js","index.js"],"names":["App","useState","code","setCode","user","setUser","token","setToken","loading","setLoading","client_id","host","useEffect","queryString","parse","window","location","search","exchangeCode","logIn","e","a","preventDefault","redirect_url","href","includes","arr","split","console","log","url","logout","body","access_token","refresh_token","fetch","headers","Accept","method","JSON","stringify","then","response","json","data","catch","err","alert","localStorage","tokenSSO","name","className","toString","toUpperCase","type","onClick","style","width","height","color","role","ReactDOM","render","document","getElementById"],"mappings":"gNA0JeA,MAvJf,WACE,MAAwBC,mBAAS,IAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAwBF,mBAAS,IAAjC,mBAAOG,EAAP,KAAaC,EAAb,KACA,EAA0BJ,mBAAS,IAAnC,mBAAOK,EAAP,KAAcC,EAAd,KACA,EAA8BN,oBAAS,GAAvC,mBAAOO,EAAP,KAAgBC,EAAhB,KAEMC,EAAY,MAEZC,EAAO,wBAEbC,qBAAU,WACRP,EAAQ,IACRF,EAAQU,IAAYC,MAAMC,OAAOC,SAASC,QAAQf,MAC9CA,GACFgB,EAAahB,KAEd,CAACA,IAEJ,IAAMiB,EAAK,uCAAG,WAAOC,GAAP,mBAAAC,EAAA,sDACZD,EAAEE,kBACEC,EAAeR,OAAOC,SAASQ,MAElBC,SAAS,YACpBC,EAAMH,EAAaI,MAAM,UAC7BJ,EAAeG,EAAI,IAErBE,QAAQC,IAAIN,GAERO,EAVQ,UAUCnB,EAVD,uBAUoBD,EAVpB,yBAU8Ca,GAE1DR,OAAOC,SAASQ,KAAOM,EAZX,2CAAH,sDAeLC,EAAM,uCAAG,WAAOX,GAAP,eAAAC,EAAA,sDACbD,EAAEE,iBAEEU,EAAO,CACTC,aAAc3B,EAAM2B,aACpBC,cAAe5B,EAAM4B,cACrBxB,UAAWA,GAGbyB,MAAM,GAAD,OAAIxB,EAAJ,YAAoB,CACvByB,QAAS,CACPC,OAAQ,mBACR,eAAgB,oBAElBC,OAAQ,OACRN,KAAMO,KAAKC,UAAUR,KAEpBS,MAAK,SAACC,GAAD,OAAcA,EAASC,UAC5BF,MAAK,SAACG,GACLnC,GAAW,GACXJ,EAAQ,CAAEuC,YAEXC,OAAM,SAACC,GACNrC,GAAW,GACC,0DAARqC,GACFC,MAAM,mBAzBC,2CAAH,sDA8BN7B,EAAY,uCAAG,WAAOhB,GAAP,iBAAAmB,EAAA,sDAEfW,EAAO,CACT9B,KAAMA,EACNQ,UAAWA,GAEbyB,MAAM,GAAD,OAAIxB,EAAJ,iBAAyB,CAC5ByB,QAAS,CACPC,OAAQ,mBACR,eAAgB,oBAElBC,OAAQ,OACRN,KAAMO,KAAKC,UAAUR,KAEpBS,MAAK,SAACC,GAAD,OAAcA,EAASC,UAC5BF,MAAK,SAACG,GACLI,aAAaC,SAAWV,KAAKC,UAAUI,GACvCtC,EAAQiC,KAAKzB,MAAMkC,aAAaC,UAChC1C,EAASD,GACT,IAAI0B,EAAO,CACTC,aAAc3B,EAAM2B,cAItB,OAAOE,MAAM,GAAD,OAAIxB,EAAJ,aAAqB,CAC/ByB,QAAS,CACPC,OAAQ,mBACR,eAAgB,oBAElBC,OAAQ,OACRN,KAAMO,KAAKC,UAAUR,QAGxBS,MAAK,SAACC,GAAD,OAAcA,EAASC,UAC5BF,MAAK,SAACG,GACLnC,GAAW,GACXJ,EAAQ,CAAEuC,YAEXC,OAAM,SAACC,GACNrC,GAAW,GACC,0DAARqC,GACFC,MAAM,mBAzCO,2CAAH,sDA8ClB,OAAI3C,EAAKwC,MACHxC,EAAKwC,KAAKM,KAEV,gCACE,qBAAKC,UAAU,qCAAf,SACE,0CAAa/C,EAAKwC,KAAKM,KAAKE,WAAWC,mBAEzC,qBAAKF,UAAU,qCAAf,SACE,wBACEG,KAAK,SACLH,UAAU,qBACVI,QAASxB,EAHX,yBAaNvB,EAEA,qBAAK2C,UAAU,wCAAf,SACE,qBACEA,UAAU,iBACVK,MAAO,CAAEC,MAAO,IAAKC,OAAQ,IAAKC,MAAO,aACzCC,KAAK,aAOX,qBAAKT,UAAU,qCAAf,SACE,wBAAQG,KAAK,SAASH,UAAU,qBAAqBI,QAASpC,EAA9D,sBC/IN0C,IAASC,OAAO,cAAC,EAAD,IAASC,SAASC,eAAe,W","file":"static/js/main.adf085b6.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport queryString from \"query-string\";\n\nfunction App() {\n  const [code, setCode] = useState(\"\");\n  const [user, setUser] = useState({});\n  const [token, setToken] = useState({});\n  const [loading, setLoading] = useState(false);\n\n  const client_id = \"RSK\";\n  // const host = \"http://10.10.2.82\";\n  const host = \"http://localhost:8000\";\n\n  useEffect(() => {\n    setUser({});\n    setCode(queryString.parse(window.location.search).code);\n    if (code) {\n      exchangeCode(code);\n    }\n  }, [code]);\n\n  const logIn = async (e) => {\n    e.preventDefault();\n    let redirect_url = window.location.href;\n\n    if (redirect_url.includes(\"?code=\")) {\n      let arr = redirect_url.split(\"?code=\");\n      redirect_url = arr[0];\n    }\n    console.log(redirect_url);\n\n    let url = `${host}/?client_id=${client_id}&redirect_url=${redirect_url}`;\n\n    window.location.href = url;\n  };\n\n  const logout = async (e) => {\n    e.preventDefault();\n\n    let body = {\n      access_token: token.access_token,\n      refresh_token: token.refresh_token,\n      client_id: client_id,\n    };\n\n    fetch(`${host}/signOut`, {\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      },\n      method: \"POST\",\n      body: JSON.stringify(body),\n    })\n      .then((response) => response.json())\n      .then((data) => {\n        setLoading(false);\n        setUser({ data });\n      })\n      .catch((err) => {\n        setLoading(false);\n        if (err === \"SyntaxError: Unexpected token i in JSON at position 0\") {\n          alert(\"invalid code\");\n        }\n      });\n  };\n\n  const exchangeCode = async (code) => {\n    let token;\n    let body = {\n      code: code,\n      client_id: client_id,\n    };\n    fetch(`${host}/exchangeCode`, {\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      },\n      method: \"POST\",\n      body: JSON.stringify(body),\n    })\n      .then((response) => response.json())\n      .then((data) => {\n        localStorage.tokenSSO = JSON.stringify(data);\n        token = JSON.parse(localStorage.tokenSSO);\n        setToken(token);\n        let body = {\n          access_token: token.access_token,\n        };\n\n        //CHECK SSO\n        return fetch(`${host}/checkSSO`, {\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n          },\n          method: \"POST\",\n          body: JSON.stringify(body),\n        });\n      })\n      .then((response) => response.json())\n      .then((data) => {\n        setLoading(false);\n        setUser({ data });\n      })\n      .catch((err) => {\n        setLoading(false);\n        if (err === \"SyntaxError: Unexpected token i in JSON at position 0\") {\n          alert(\"invalid code\");\n        }\n      });\n  };\n\n  if (user.data) {\n    if (user.data.name) {\n      return (\n        <div>\n          <div className=\"d-flex justify-content-center pt-5\">\n            <h1>WELCOME {user.data.name.toString().toUpperCase()}</h1>\n          </div>\n          <div className=\"d-flex justify-content-center pt-5\">\n            <button\n              type=\"submit\"\n              className=\"btn-lg btn-primary\"\n              onClick={logout}\n            >\n              logout\n            </button>\n          </div>\n        </div>\n      );\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"d-flex justify-content-center p-5 m-5\">\n        <div\n          className=\"spinner-border\"\n          style={{ width: 115, height: 115, color: \"lightblue\" }}\n          role=\"status\"\n        ></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"d-flex justify-content-center pt-5\">\n      <button type=\"submit\" className=\"btn-lg btn-primary\" onClick={logIn}>\n        Login\n      </button>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}